



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the StrangeScout scouting system">
      
      
        <link rel="canonical" href="https://the-red-alliance.github.io/strangescout-docs/installation-guide/">
      
      
        <meta name="author" content="The Red Alliance projects maintainers">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Installation Guide - StrangeScout Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Noto Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#before-you-install" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://the-red-alliance.github.io/strangescout-docs/" title="StrangeScout Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon">book</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              StrangeScout Docs
            </span>
            <span class="md-header-nav__topic">
              
                Installation Guide
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/the-red-alliance/strangescout-deploy" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Deployment Repo
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://the-red-alliance.github.io/strangescout-docs/" title="StrangeScout Docs" class="md-nav__button md-logo">
      
        <i class="md-icon">book</i>
      
    </a>
    StrangeScout Docs
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/the-red-alliance/strangescout-deploy" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Deployment Repo
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Installation Guide
      </label>
    
    <a href="./" title="Installation Guide" class="md-nav__link md-nav__link--active">
      Installation Guide
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-you-install" class="md-nav__link">
    Before you install
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-reverse-proxy" class="md-nav__link">
    Setting up the reverse proxy
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-docker-network" class="md-nav__link">
    Creating a docker network
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-certificate-file" class="md-nav__link">
    Creating the certificate file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-compose-file" class="md-nav__link">
    Creating the compose file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starting-the-reverse-proxy" class="md-nav__link">
    Starting the reverse proxy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-database" class="md-nav__link">
    Setting up the database
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-compose-file_1" class="md-nav__link">
    Creating the compose file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starting-the-database" class="md-nav__link">
    Starting the database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-strangescout" class="md-nav__link">
    Building StrangeScout
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cloning-the-repository" class="md-nav__link">
    Cloning the repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-the-image" class="md-nav__link">
    Building the image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-strangescout" class="md-nav__link">
    Setting up StrangeScout
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-compose-file_2" class="md-nav__link">
    Creating the compose file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-strangescout" class="md-nav__link">
    Starting StrangeScout
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-webhooks" class="md-nav__link">
    Setting Up Webhooks
  </a>
  
</li>
      
      
      
      
        
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../scouter-guide/" title="Scouter Guide" class="md-nav__link">
      Scouter Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../premade-templates/" title="Premade Game Templates" class="md-nav__link">
      Premade Game Templates
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      StrangeScout API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        StrangeScout API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../strangescout-api/authentication-routes/" title="Authentication Routes" class="md-nav__link">
      Authentication Routes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-you-install" class="md-nav__link">
    Before you install
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-reverse-proxy" class="md-nav__link">
    Setting up the reverse proxy
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-docker-network" class="md-nav__link">
    Creating a docker network
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-certificate-file" class="md-nav__link">
    Creating the certificate file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-compose-file" class="md-nav__link">
    Creating the compose file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starting-the-reverse-proxy" class="md-nav__link">
    Starting the reverse proxy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-database" class="md-nav__link">
    Setting up the database
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-compose-file_1" class="md-nav__link">
    Creating the compose file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starting-the-database" class="md-nav__link">
    Starting the database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-strangescout" class="md-nav__link">
    Building StrangeScout
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cloning-the-repository" class="md-nav__link">
    Cloning the repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-the-image" class="md-nav__link">
    Building the image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-strangescout" class="md-nav__link">
    Setting up StrangeScout
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-compose-file_2" class="md-nav__link">
    Creating the compose file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-strangescout" class="md-nav__link">
    Starting StrangeScout
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-webhooks" class="md-nav__link">
    Setting Up Webhooks
  </a>
  
</li>
      
      
      
      
        
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Installation Guide</h1>
                
                <!-- Disables disqus comment system for this page -->

<h2 id="before-you-install">Before you install<a class="headerlink" href="#before-you-install" title="Permanent link">&para;</a></h2>
<p>The following installation guide will document setup with <a href="https://www.docker.com/">Docker</a> because it's what we at <em>Team 1533 Triple Strange</em> and <em>The Red Alliance</em> use. It's also important to note that StrangeScout is designed to be run behind a reverse proxy, and as such does <strong>not</strong> have built-in support for HTTPS certificates. We do provide example configurations using the <a href="https://containo.us/traefik/">traefik reverse proxy</a>, but you are more than welcome to use your own reverse proxy, or even fork the code and roll in your own support for HTTPS.</p>
<h3 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h3>
<p>StrangeScout only has two true dependencies:</p>
<ul>
<li><a href="https://www.docker.com/">Docker</a></li>
<li><a href="https://docs.docker.com/compose/">Docker Compose</a></li>
</ul>
<p><em>Docker</em> is the program that allows services to be run as individual <em>containers</em> on a host machine, and <em>Docker Compose</em> is a utility that simplifies choreography of multiple docker containers.</p>
<p>You will also need to have a domain pointing at the server you're installing StrangeScout on.</p>
<hr />
<p>First, install Docker following the available installation instructions for your distribution of choice, for example on an x86_64 Ubuntu server you would run the following (as root):</p>
<p><a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/#install-using-the-repository"><em>official instructions</em></a></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1"># update package lists</span>
apt-get update

<span class="c1"># install packages to add repositories</span>
apt-get install <span class="se">\</span>
    apt-transport-https <span class="se">\</span>
    ca-certificates <span class="se">\</span>
    curl <span class="se">\</span>
    gnupg-agent <span class="se">\</span>
    software-properties-common

<span class="c1"># add the docker GPG key</span>
curl -fsSL https://download.docker.com/linux/ubuntu/gpg <span class="p">|</span> sudo apt-key add -

<span class="c1"># add the docker x86_64 repository</span>
add-apt-repository <span class="se">\</span>
   <span class="s2">&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \</span>
<span class="s2">   </span><span class="k">$(</span>lsb_release -cs<span class="k">)</span><span class="s2"> \</span>
<span class="s2">   stable&quot;</span>

<span class="c1"># update package lists</span>
apt-get update

<span class="c1"># install docker packages</span>
apt-get install docker-ce docker-ce-cli containerd.io
</pre></div>
</td></tr></table>

<hr />
<p>Secondly, install Docker Compose following the available installation instructions for your distribution of choice, for example on a *nix server you would run the following (as root):</p>
<p><a href="https://docs.docker.com/compose/install/#install-compose"><em>official instructions</em></a></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1"># save the docker-compose script to the bin</span>
curl -L <span class="s2">&quot;https://github.com/docker/compose/releases/download/1.25.0/docker-compose-</span><span class="k">$(</span>uname -s<span class="k">)</span><span class="s2">-</span><span class="k">$(</span>uname -m<span class="k">)</span><span class="s2">&quot;</span> -o /usr/local/bin/docker-compose

<span class="c1"># make it executable</span>
chmod +x /usr/local/bin/docker-compose
</pre></div>
</td></tr></table>

<hr />
<p>After both dependencies have been installed, ensure the Docker system service has been started and enabled:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>systemctl start docker
systemctl <span class="nb">enable</span> docker
</pre></div>
</td></tr></table>

<h2 id="setting-up-the-reverse-proxy">Setting up the reverse proxy<a class="headerlink" href="#setting-up-the-reverse-proxy" title="Permanent link">&para;</a></h2>
<p>Now that all dependencies have been installed we can begin setting up traefik for our reverse proxy.</p>
<p>For the sake of organization and due to the way docker-compose names containers, you should make a directory to store the reverse proxy files. Run the following two commands before continuing to setup the reverse proxy:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>mkdir -v reverse-proxy
<span class="nb">cd</span> reverse-proxy
</pre></div>
</td></tr></table>

<h3 id="creating-a-docker-network">Creating a docker network<a class="headerlink" href="#creating-a-docker-network" title="Permanent link">&para;</a></h3>
<p>The first step to setting up traefik is to create a new docker network:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>docker network create strangescout_main
</pre></div>
</td></tr></table>

<p>This will allow for containers on the same network to easily communicate with each other. In our case it allows for the StrangeScout server to communicate with the database in its own separate container.</p>
<h3 id="creating-the-certificate-file">Creating the certificate file<a class="headerlink" href="#creating-the-certificate-file" title="Permanent link">&para;</a></h3>
<p>Any modern website should be served using the HTTPS protocol. This ensures any data sent to or from the users is encrypted and cannot be read by unauthorized persons. Our reverse proxy, traefik, has built in support for HTTPS, and can automatically update certificates for HTTPS using ACME (Automated Certificate Management Environment). To do so, we need somewhere to store these certificates. Create a file with the following command as root:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>touch acme.json
</pre></div>
</td></tr></table>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order for traefik to store certificates in this file, it must be owned by root. When creating the file, ensure you're running the command as root or using sudo!</p>
</div>
<p>In order to work properly, we need to set specific permissions on this file. It must <em>ONLY</em> be readable and writable by root. Update the files permissions with the following command as root:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>chmod <span class="m">600</span> acme.json
</pre></div>
</td></tr></table>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>chmod</code> is used to update file attributes. In this case, we're setting the file permissions to 600, which corresponds to R/W for the owner, and no permissions for anyone else. Because the file is owned by root, only root can access the file. If these permissions are not set traefik will not be able to get certificates.</p>
</div>
<h3 id="creating-the-compose-file">Creating the compose file<a class="headerlink" href="#creating-the-compose-file" title="Permanent link">&para;</a></h3>
<p>Now that our network and ACME certificate file have been created, we can put together the docker-compose file for the reverse proxy. To start, we need to create our compose file:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>touch docker-compose.yml
</pre></div>
</td></tr></table>

<hr />
<p>Now that we have our compose file, let's start with some basic options:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">reverse-proxy</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">traefik:v2.0</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>
</pre></div>
</td></tr></table>

<p>What we're doing here is start off by stating that we're using version 3.3 of the docker-compose syntax. Next we start our list of services, and define a service with the name <code>reverse-proxy</code>. Within the reverse-proxy service we specify that it should use the <code>traefik:v2.0</code> image from Docker Hub, that the container name should be <code>reverse-proxy</code>, the hostname should be <code>reverse-proxy</code>, and the container should always restart if it fails.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the <em>hostname</em> key sets friendly names that containers can be accessed by on the docker network we created earlier. While this isn't necessary for the reverse proxy container, it will be useful later when we want to specify the url to access the database at.</p>
</div>
<hr />
<p>Next, we'll add some command line options that will be given to traefik when it runs:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">reverse-proxy</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">traefik:v2.0</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

<span class="hll">        <span class="nt">command</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--providers.docker</span>
</span><span class="hll">
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.web.address=:80</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.websecure.address=:443</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.mongodb.address=:27017</span>
</span><span class="hll">
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.caserver=https://acme-v02.api.letsencrypt.org/directory</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.email=&lt;youremail@yourdomain.tld&gt;</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.storage=/acme.json</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.tlschallenge=true</span>
</span></pre></div>
</td></tr></table>

<ul>
<li><code>--providers.docker</code> tells traefik we have services running via docker</li>
<li><code>--entrypoints.web.address=:80</code>: Sets the port on the entrypoint named <code>web</code> to port 80</li>
<li><code>--entrypoints.websecure.address=:443</code> sets the port on the entrypoint named <code>websecure</code> to port 443</li>
<li><code>--entrypoints.mongodb.address=:27017</code> sets the port on the entrypoint named <code>mongodb</code> to port 27017</li>
<li><code>--certificatesresolvers.leresolver.acme.caserver=https://acme-v02.api.letsencrypt.org/directory</code> sets the URL of the ca server to use for ACME certificates</li>
<li><code>--certificatesresolvers.leresolver.acme.email=&lt;youremail@yourdomain.tld&gt;</code> sets the email used when acquiring certificates</li>
<li><code>--certificatesresolvers.leresolver.acme.storage=/acme.json</code> tells traefik where to store certificates</li>
<li><code>--certificatesresolvers.leresolver.acme.tlschallenge=true</code> tells traefik what method to use to get certificates</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Entrypoints are points where network traffic can enter traefik to be routed. The <code>web</code> entrypoint will be used for unencrypted HTTP traffic (we'll be setting it up to automatically redirect to HTTPS as well), the <code>websecure</code> entrypoint for encrypted HTTPS traffic, and the <code>mongodb</code> entrypoint for direct access to our database.</p>
</div>
<hr />
<p>Next we need to open the ports that we defined in our traefik entrypoints:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">reverse-proxy</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">traefik:v2.0</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

        <span class="nt">command</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--providers.docker</span>

            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.web.address=:80</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.websecure.address=:443</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.mongodb.address=:27017</span>

            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.caserver=https://acme-v02.api.letsencrypt.org/directory</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.email=&lt;youremail@yourdomain.tld&gt;</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.storage=/acme.json</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.tlschallenge=true</span>

<span class="hll">        <span class="nt">ports</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="s">&#39;80:80&#39;</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="s">&#39;443:443&#39;</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="s">&#39;27017:27017&#39;</span>
</span></pre></div>
</td></tr></table>

<p>Each port definition has two parts, separated by a <code>:</code> colon. The first part describes the port to map to on the host machine, while the second part is the port to bind to within the container. For example, <code>80:80</code> means that requests to port 80 on the host machine will route to port 80 within the container. In our case we are routing ports 80, 443, and 27017 on the host machine to those same ports within the traefik container.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Port definitions can also be more specific, including a specific interface they should listen to. For example, <code>127.0.0.1:80:80</code> would only map traffic on port 80 from localhost to the container.</p>
</div>
<hr />
<p>The next step is to setup some volumes:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">reverse-proxy</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">traefik:v2.0</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

        <span class="nt">command</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--providers.docker</span>

            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.web.address=:80</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.websecure.address=:443</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.mongodb.address=:27017</span>

            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.caserver=https://acme-v02.api.letsencrypt.org/directory</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.email=&lt;youremail@yourdomain.tld&gt;</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.storage=/acme.json</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.tlschallenge=true</span>

        <span class="nt">ports</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&#39;80:80&#39;</span>
            <span class="p p-Indicator">-</span> <span class="s">&#39;443:443&#39;</span>
            <span class="p p-Indicator">-</span> <span class="s">&#39;27017:27017&#39;</span>

<span class="hll">        <span class="nt">volumes</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="s">&quot;./acme.json:/acme.json&quot;</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="s">&quot;/var/run/docker.sock:/var/run/docker.sock:ro&quot;</span>
</span></pre></div>
</td></tr></table>

<p>Here we are defining two volumes for the container.</p>
<ul>
<li><code>"./acme.json:/acme.json"</code> mounts our ACME certificate file to <code>/acme.json</code> in the container, which is where we've told traefik to look for it</li>
<li><code>"/var/run/docker.sock:/var/run/docker.sock:ro"</code> mounts our host machine's docker socket read-only inside the container</li>
</ul>
<p>Mounting the docker socket in the container allows traefik to find out which containers it needs to connect to and what traffic to route to them.</p>
<hr />
<p>Next we need to set some labels on the container, which will be used to configure some additional features:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">reverse-proxy</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">traefik:v2.0</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

        <span class="nt">command</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--providers.docker</span>

            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.web.address=:80</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.websecure.address=:443</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.mongodb.address=:27017</span>

            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.caserver=https://acme-v02.api.letsencrypt.org/directory</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.email=&lt;youremail@yourdomain.tld&gt;</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.storage=/acme.json</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.tlschallenge=true</span>

        <span class="nt">ports</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&#39;80:80&#39;</span>
            <span class="p p-Indicator">-</span> <span class="s">&#39;443:443&#39;</span>
            <span class="p p-Indicator">-</span> <span class="s">&#39;27017:27017&#39;</span>

        <span class="nt">volumes</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;./acme.json:/acme.json&quot;</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;/var/run/docker.sock:/var/run/docker.sock:ro&quot;</span>

<span class="hll">        <span class="nt">labels</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.middlewares.compress.compress=true</span>
</span><span class="hll">
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https</span>
</span><span class="hll">
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.redirs.rule=hostregexp(`{host:.+}`)</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.redirs.entrypoints=web</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.redirs.middlewares=redirect-to-https</span>
</span></pre></div>
</td></tr></table>

<ul>
<li><code>traefik.http.middlewares.compress.compress=true</code> creates a new traefik middleware called <em>compress</em> that compresses traffic</li>
<li><code>traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https</code> creates a middleware that redirects traffic to HTTPS</li>
<li><code>traefik.http.routers.redirs.rule=hostregexp(`{host:.+}`)</code> creates a router that matches to all domains</li>
<li><code>traefik.http.routers.redirs.entrypoints=web</code> sets the router to listen on the HTTP <em>web</em> entrypoint</li>
<li><code>traefik.http.routers.redirs.middlewares=redirect-to-https</code> enables the HTTPS redirection middleware</li>
</ul>
<p>Essentially, these labels enable compression on web traffic and automatically redirect any HTTP traffic to HTTPS.</p>
<hr />
<p>Finally, we can add our docker network:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">reverse-proxy</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">traefik:v2.0</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">reverse-proxy</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

        <span class="nt">command</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--providers.docker</span>

            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.web.address=:80</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.websecure.address=:443</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--entrypoints.mongodb.address=:27017</span>

            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.caserver=https://acme-v02.api.letsencrypt.org/directory</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.email=&lt;youremail@yourdomain.tld&gt;</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.storage=/acme.json</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--certificatesresolvers.leresolver.acme.tlschallenge=true</span>

        <span class="nt">ports</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&#39;80:80&#39;</span>
            <span class="p p-Indicator">-</span> <span class="s">&#39;443:443&#39;</span>
            <span class="p p-Indicator">-</span> <span class="s">&#39;27017:27017&#39;</span>

        <span class="nt">volumes</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;./acme.json:/acme.json&quot;</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;/var/run/docker.sock:/var/run/docker.sock:ro&quot;</span>

        <span class="nt">labels</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.middlewares.compress.compress=true</span>

            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https</span>

            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.redirs.rule=hostregexp(`{host:.+}`)</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.redirs.entrypoints=web</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.redirs.middlewares=redirect-to-https</span>

<span class="hll">        <span class="nt">networks</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">strangescout_main</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">networks</span><span class="p">:</span>
</span><span class="hll">    <span class="nt">strangescout_main</span><span class="p">:</span>
</span><span class="hll">        <span class="nt">external</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</span></pre></div>
</td></tr></table>

<p>There are two parts to adding the network. First, we tell our reverse-proxy service to attach to the <code>strangescout_main</code> network, then we define the network in the top level of the compose file.</p>
<h3 id="starting-the-reverse-proxy">Starting the reverse proxy<a class="headerlink" href="#starting-the-reverse-proxy" title="Permanent link">&para;</a></h3>
<p>To start the reverse proxy you only need to run one command:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>docker-compose up -d
</pre></div>
</td></tr></table>

<p>As long as you're in the same directory as the <code>docker-compose.yml</code> file, it will automatically be read and the service will start up and fork to the background thanks to the <code>-d</code> flag!</p>
<h2 id="setting-up-the-database">Setting up the database<a class="headerlink" href="#setting-up-the-database" title="Permanent link">&para;</a></h2>
<p>After we've setup the reverse proxy, we'll need a database to store our scouting data. In the case of StrangeScout we use <a href="https://www.mongodb.com/">MongoDB</a>.</p>
<p>As with the reverse proxy, we'll once again create a directory to store the database files:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>mkdir -v database
<span class="nb">cd</span> database
</pre></div>
</td></tr></table>

<hr />
<p>We also need persistent storage for the database, so we'll create a directory for that as well:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>mkdir mongodb_data
</pre></div>
</td></tr></table>

<h3 id="creating-the-compose-file_1">Creating the compose file<a class="headerlink" href="#creating-the-compose-file_1" title="Permanent link">&para;</a></h3>
<p>To start, we need to create our compose file:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>touch docker-compose.yml
</pre></div>
</td></tr></table>

<hr />
<p>The compose file for the database will start very similarly to that of the reverse proxy:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">mongodb</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongo:4.2.2</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongodb</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongodb</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>
</pre></div>
</td></tr></table>

<hr />
<p>Next, we need to mount our data directory into the container:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">mongodb</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongo:4.2.2</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongodb</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongodb</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

<span class="hll">        <span class="nt">volumes</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="s">&quot;./mongodb_data:/data/db&quot;</span>
</span></pre></div>
</td></tr></table>

<hr />
<p>Next we need to setup the root database account:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">mongodb</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongo:4.2.2</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongodb</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongodb</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

        <span class="nt">volumes</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;./mongodb_data:/data/db&quot;</span>

<span class="hll">        <span class="nt">environment</span><span class="p">:</span>
</span><span class="hll">            <span class="nt">MONGO_INITDB_ROOT_USERNAME</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">root</span>
</span><span class="hll">            <span class="nt">MONGO_INITDB_ROOT_PASSWORD</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example-password</span>
</span></pre></div>
</td></tr></table>

<ul>
<li><code>MONGO_INITDB_ROOT_USERNAME: root</code> sets the database's root account username to <code>root</code></li>
<li><code>MONGO_INITDB_ROOT_PASSWORD: example-password</code> sets the account password to <code>example-password</code></li>
</ul>
<p>By convention you'll probably want to leave the username as root. Make sure the password is something secure because this account will have full read/write access to the entire database!</p>
<hr />
<p>Now we need to set some labels to tell our reverse proxy how to route database traffic:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">mongodb</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongo:4.2.2</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongodb</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongodb</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

        <span class="nt">volumes</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;./mongodb_data:/data/db&quot;</span>

        <span class="nt">environment</span><span class="p">:</span>
            <span class="nt">MONGO_INITDB_ROOT_USERNAME</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">root</span>
            <span class="nt">MONGO_INITDB_ROOT_PASSWORD</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example-password</span>

<span class="hll">        <span class="nt">labels</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.tcp.routers.mongodb.entrypoints=mongodb</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.tcp.routers.mongodb.rule=HostSNI(`*`)</span>
</span></pre></div>
</td></tr></table>

<ul>
<li><code>traefik.tcp.routers.mongodb.entrypoints=mongodb</code> tells traefik to put this container on a TCP router with the <code>mongodb</code> entrypoint we setup that allows traffic on MongoDB's port 27017</li>
<li><code>traefik.tcp.routers.mongodb.rule=HostSNI(`*`)</code> tells traefik to match all domains, which is required for traefik TCP services</li>
</ul>
<hr />
<p>Finally, we attach the docker network to the container:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">mongodb</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongo:4.2.2</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongodb</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">mongodb</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

        <span class="nt">volumes</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;./mongodb_data:/data/db&quot;</span>

        <span class="nt">environment</span><span class="p">:</span>
            <span class="nt">MONGO_INITDB_ROOT_USERNAME</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">root</span>
            <span class="nt">MONGO_INITDB_ROOT_PASSWORD</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example-password</span>

        <span class="nt">labels</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.tcp.routers.mongodb.entrypoints=mongodb</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.tcp.routers.mongodb.rule=HostSNI(`*`)</span>

<span class="hll">        <span class="nt">networks</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">strangescout_main</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">networks</span><span class="p">:</span>
</span><span class="hll">    <span class="nt">strangescout_main</span><span class="p">:</span>
</span><span class="hll">        <span class="nt">external</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</span></pre></div>
</td></tr></table>

<h3 id="starting-the-database">Starting the database<a class="headerlink" href="#starting-the-database" title="Permanent link">&para;</a></h3>
<p>The database will be started with the exact same command as the reverse proxy:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>docker-compose up -d
</pre></div>
</td></tr></table>

<h2 id="building-strangescout">Building StrangeScout<a class="headerlink" href="#building-strangescout" title="Permanent link">&para;</a></h2>
<p>While we do provide prebuilt docker images, you may decide to build StrangeScout yourself. If you want to use prebuilt images you can skip this step.</p>
<h3 id="cloning-the-repository">Cloning the repository<a class="headerlink" href="#cloning-the-repository" title="Permanent link">&para;</a></h3>
<p>The first step to build any project is to clone its repository. StrangeScout has separate repositories for the frontend, backend, and deploy scripts. Since we're trying to build the final product, we want to clone the build repository. We also need to make sure we've cloned the submodules:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>git clone https://github.com/the-red-alliance/strangescout-deploy.git
<span class="nb">cd</span> strangescout-deploy
git submodule sync --recursive
git submodule update --init --force --recursive
</pre></div>
</td></tr></table>

<h3 id="building-the-image">Building the image<a class="headerlink" href="#building-the-image" title="Permanent link">&para;</a></h3>
<p>Thanks to the premade Dockerfile, building the image is as simple as one command:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>docker image build -t strangescout .
</pre></div>
</td></tr></table>

<p>Once the command completes, you'll have a docker image tagged <code>strangescout</code>!</p>
<h2 id="setting-up-strangescout">Setting up StrangeScout<a class="headerlink" href="#setting-up-strangescout" title="Permanent link">&para;</a></h2>
<p>Once again we'll start by creating a self contained directory:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>mkdir -v strangescout
<span class="nb">cd</span> strangescout
</pre></div>
</td></tr></table>

<h3 id="creating-the-compose-file_2">Creating the compose file<a class="headerlink" href="#creating-the-compose-file_2" title="Permanent link">&para;</a></h3>
<p>The StrangeScout service itself doesn't require any persistent volumes or other local files, so all we have to do is create a compose file:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>touch docker-compose.yml
</pre></div>
</td></tr></table>

<p>And start editing:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">strangescout</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">theredalliance/strangescout:latest</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strangescout</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strangescout</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>
</pre></div>
</td></tr></table>

<p>We once again start the same way as the database and reverse proxy services. Here we're using the latest prebuilt image, but if you built the image yourself you should put whatever you tagged it as for the <code>image</code> key. A list of prebuilt image tags can be found here: <a href="https://hub.docker.com/r/theredalliance/strangescout/tags">https://hub.docker.com/r/theredalliance/strangescout/tags</a></p>
<hr />
<p>Next we need to set some environment variables:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">strangescout</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">theredalliance/strangescout:latest</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strangescout</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strangescout</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

<span class="hll">        <span class="nt">environment</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SECRET=jwt-secret</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="s">&quot;DB_URL=mongodb://root:db-password@mongodb:27017/dbname?authSource=admin&quot;</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">DB_DEBUG=true</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ADMIN_EMAIL=email@yourdomain.tld</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ADMIN_PASSWORD=supersecretpassword</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">TBA_KEY=xxx</span>
</span></pre></div>
</td></tr></table>

<ul>
<li><code>SECRET=jwt-secret</code> sets the secret used to encrypt the tokens used for authenticating users. This should be a random string of your choice.</li>
<li><code>"DB_URL=mongodb://root:db-password@mongodb:27017/dbname?authSource=admin"</code> sets the URL of the database.<ul>
<li><code>root:db-password</code> corresponds to the root username and password we set up earlier.</li>
<li><code>@mongodb:27017</code> says to go to port 27017 - the default MongoDB port, at hostname <code>mongodb</code>, which is what we set the database container hostname to.</li>
<li><code>dbname</code> is the name of the database within Mongo that your data will be stored in, and can be set to anything you want following the rules set here: <a href="https://docs.mongodb.com/manual/reference/limits/#restrictions-on-db-names">https://docs.mongodb.com/manual/reference/limits/#restrictions-on-db-names</a>.</li>
<li><code>?authSource=admin</code> says to use the <code>admin</code> database to find the user. This should not be changed.</li>
</ul>
</li>
<li><code>DB_DEBUG</code> enables debug logs from the backend (omit completely to disable)</li>
<li><code>ADMIN_EMAIL</code> sets the email address of the default strangescout admin account</li>
<li><code>ADMIN_PASSWORD</code> sets the password for the default admin account</li>
<li><code>TBA_KEY</code> sets the API key for The Blue Alliance integration</li>
</ul>
<hr />
<p>Next we need to add a template file. StrangeScout uses a YAML file to define the game. Premade templates can be found under <a href="../premade-templates/">Premade Game Templates</a>. To use your template, we need to mount it as a volume:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">strangescout</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">theredalliance/strangescout:latest</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strangescout</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strangescout</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

        <span class="nt">environment</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SECRET=jwt-secret</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;DB_URL=mongodb://root:db-password@mongodb:27017/dbname?authSource=admin&quot;</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">DB_DEBUG=true</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ADMIN_EMAIL=email@yourdomain.tld</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ADMIN_PASSWORD=supersecretpassword</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">TBA_KEY=xxx</span>

<span class="hll">        <span class="nt">volumes</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./template.yml:/template.yml</span>
</span></pre></div>
</td></tr></table>

<p><code>./template.yml:/template.yml</code> tells docker to mount the file <code>./template.yml</code> at <code>/template.yml</code> inside the container. Change the first part of the mount to point to your template file.</p>
<hr />
<p>Next we need to set some labels to tell Traefik how to route our container:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">strangescout</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">theredalliance/strangescout:latest</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strangescout</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strangescout</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

        <span class="nt">environment</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SECRET=jwt-secret</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;DB_URL=mongodb://root:db-password@mongodb:27017/dbname?authSource=admin&quot;</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">DB_DEBUG=true</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ADMIN_EMAIL=email@yourdomain.tld</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ADMIN_PASSWORD=supersecretpassword</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">TBA_KEY=xxx</span>

        <span class="nt">volumes</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./template.yml:/template.yml</span>

<span class="hll">        <span class="nt">labels</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.strangescout.rule=Host(`&lt;yourdomain.tld&gt;`)</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.strangescout.entrypoints=websecure</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.strangescout.tls.certresolver=leresolver</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.strangescout.middlewares=compress</span>
</span></pre></div>
</td></tr></table>

<ul>
<li><code>traefik.http.routers.strangescout.rule=Host(`&lt;yourdomain.tld&gt;`)</code> tells traefik what domain to route to StrangeScout. Change <code>&lt;yourdomain.tld&gt;</code> accordingly.</li>
<li><code>traefik.http.routers.strangescout.entrypoints=websecure</code> tells traefik to redirect traffic to HTTPS</li>
<li><code>traefik.http.routers.strangescout.tls.certresolver=leresolver</code> tells traefik to automatically get HTTPS certificates</li>
<li><code>traefik.http.routers.strangescout.middlewares=compress</code> tells traefik to compress traffic</li>
</ul>
<hr />
<p>The final step is to set the docker network:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># docker-compose.yml</span>

<span class="nt">version</span><span class="p">:</span> <span class="s">&#39;3.3&#39;</span>

<span class="nt">services</span><span class="p">:</span>
    <span class="nt">strangescout</span><span class="p">:</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">theredalliance/strangescout:latest</span>
        <span class="nt">container_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strangescout</span>
        <span class="nt">hostname</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">strangescout</span>
        <span class="nt">restart</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">always</span>

        <span class="nt">environment</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SECRET=jwt-secret</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;DB_URL=mongodb://root:db-password@mongodb:27017/dbname?authSource=admin&quot;</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">DB_DEBUG=true</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ADMIN_EMAIL=email@yourdomain.tld</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ADMIN_PASSWORD=supersecretpassword</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">TBA_KEY=xxx</span>

        <span class="nt">volumes</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">./template.yml:/template.yml</span>

        <span class="nt">labels</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.strangescout.rule=Host(`&lt;yourdomain.tld&gt;`)</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.strangescout.entrypoints=websecure</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.strangescout.tls.certresolver=leresolver</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.strangescout.middlewares=compress</span>

<span class="hll">        <span class="nt">networks</span><span class="p">:</span>
</span><span class="hll">            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">strangescout_main</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">networks</span><span class="p">:</span>
</span><span class="hll">    <span class="nt">strangescout_main</span><span class="p">:</span>
</span><span class="hll">        <span class="nt">external</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</span></pre></div>
</td></tr></table>

<h2 id="starting-strangescout">Starting StrangeScout<a class="headerlink" href="#starting-strangescout" title="Permanent link">&para;</a></h2>
<p>We can now start StrangeScout:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>docker-compose up -d
</pre></div>
</td></tr></table>

<h2 id="setting-up-webhooks">Setting Up Webhooks<a class="headerlink" href="#setting-up-webhooks" title="Permanent link">&para;</a></h2>
<p>StrangeScout supports webhooks from The Blue Alliance API. So set them up, go to your api account on The Blue Alliance, and add a new webhook at url <code>https://&lt;yourdomain.tld&gt;/api/webhook</code>. Follow TBA's guide to set up the webhook. When you send the verification message, the code will be logged to the containers logs, along with the TBA_HMAC header. To finalize setup, add <code>TBA_HMAC</code> as an environment variable in the docker-compose file and set it to the logged TBA-HMAC header, and restart the container.</p>
                
                  
                
                
              
              
                

  


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../scouter-guide/" title="Scouter Guide" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Scouter Guide
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 The Red Alliance Project
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>